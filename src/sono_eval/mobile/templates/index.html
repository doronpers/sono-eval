{% extends "base.html" %}

{% block content %}
<div class="welcome-screen">
    <div class="hero-section">
        <div class="hero-icon">üéØ</div>
        <h2 class="hero-title">Welcome to Sono-Eval</h2>
        <p class="hero-subtitle">Your personalized skill assessment companion</p>
    </div>

    <div class="value-grid" role="list">
        <div class="value-item" role="listitem">
            <span class="value-icon">‚ú®</span>
            <h3>Explained Scores</h3>
            <p>See evidence for every score‚Äîno black boxes.</p>
        </div>
        <div class="value-item" role="listitem">
            <span class="value-icon">üéØ</span>
            <h3>Choose Your Focus</h3>
            <p>Pick 1‚Äì4 skills that matter most to you.</p>
        </div>
        <div class="value-item" role="listitem">
            <span class="value-icon">‚è±Ô∏è</span>
            <h3>10‚Äì90 Minutes</h3>
            <p>Complete one area or a full profile at your pace.</p>
        </div>
        <div class="value-item" role="listitem">
            <span class="value-icon">üìà</span>
            <h3>Actionable Growth</h3>
            <p>Get specific next steps to improve.</p>
        </div>
    </div>

    <div class="cta-section">
        <button class="primary-button" onclick="location.href='/mobile/start'">
            Let's Get Started
            <span class="button-arrow">‚Üí</span>
        </button>
        <p class="cta-subtext">No account needed ‚Ä¢ 10‚Äì90 minutes</p>
    </div>

    <div class="details-section">
        <button class="details-toggle" onclick="toggleDetails(this)">
            <span>How it works</span>
            <span class="toggle-icon">‚ñº</span>
        </button>
        <div class="details-content" style="display: none;">
            <div class="detail-block">
                <h4>The Assessment Process</h4>
                <ol class="process-list">
                    <li>
                        <strong>Choose Your Focus:</strong> Select 1‚Äì4 skill areas
                    </li>
                    <li>
                        <strong>Complete Tasks:</strong> Share your code and reasoning
                    </li>
                    <li>
                        <strong>See Results:</strong> Scores backed by evidence
                    </li>
                    <li>
                        <strong>Grow Your Skills:</strong> Actionable recommendations
                    </li>
                </ol>
            </div>
            <div class="detail-block">
                <h4>Privacy</h4>
                <ul class="privacy-list">
                    <li>‚úÖ No account required</li>
                    <li>‚úÖ Your code and responses stay private</li>
                    <li>‚úÖ Transparent scoring</li>
                    <li>‚úÖ You control what you share</li>
                </ul>
            </div>
            <div class="detail-block">
                <div class="mini-quiz">
                    <p class="mini-quiz-title">Quick Reflection (optional)</p>
                    <p class="mini-quiz-text">
                        What do you hope to learn from this assessment?
                    </p>
                    <div class="reflection-options">
                        <label>
                            <input type="radio" name="reflection" value="strengths" onchange="saveReflection(this.value)">
                            <span>Identify my strengths</span>
                        </label>
                        <label>
                            <input type="radio" name="reflection" value="improve" onchange="saveReflection(this.value)">
                            <span>Find areas to improve</span>
                        </label>
                        <label>
                            <input type="radio" name="reflection" value="practice" onchange="saveReflection(this.value)">
                            <span>Practice for interviews</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function toggleDetails(button) {
    const content = button.nextElementSibling;
    const icon = button.querySelector('.toggle-icon');
    const isOpen = content.style.display === 'block';

    content.style.display = isOpen ? 'none' : 'block';
    icon.textContent = isOpen ? '‚ñº' : '‚ñ≤';

    if (window.sonoEvalTracking && window.sonoEvalTracking.trackEvent) {
        window.sonoEvalTracking.trackEvent('discovery', {
            action: isOpen ? 'collapsed' : 'expanded',
            section: 'how_it_works',
        });
    }
}

// Save reflection choice and track it
function saveReflection(value) {
    // Save to session storage for personalization
    const goals = JSON.parse(sessionStorage.getItem('goals') || '[]');
    if (!goals.includes(value)) {
        goals.push(value);
        sessionStorage.setItem('goals', JSON.stringify(goals));
    }

    // Track reflection choice
    if (window.sonoEvalTracking && window.sonoEvalTracking.trackEvent) {
        window.sonoEvalTracking.trackEvent('reflection', {
            choice: value,
            goals: goals,
        });
    }
}

// Track button clicks
document.addEventListener('DOMContentLoaded', function() {
    // Load saved reflection if any
    const savedGoals = JSON.parse(sessionStorage.getItem('goals') || '[]');
    savedGoals.forEach(goal => {
        const radio = document.querySelector(`input[name="reflection"][value="${goal}"]`);
        if (radio) radio.checked = true;
    });

    const startButton = document.querySelector('.primary-button');
    if (startButton) {
        startButton.addEventListener('click', function() {
            if (window.sonoEvalTracking && window.sonoEvalTracking.trackEvent) {
                window.sonoEvalTracking.trackEvent('navigation', {
                    action: 'start_assessment',
                    source: 'welcome_page',
                });
            }
        });
    }
});
</script>
{% endblock %}
